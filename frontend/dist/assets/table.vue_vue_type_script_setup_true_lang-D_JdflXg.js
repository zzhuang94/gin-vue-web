import{p as C,d as F,r as O,w as B,c as E,a as i,o as l,g as k,S as G,k as p,b as d,m as N,n as h,f as g,Q as D,bZ as L,F as y,U as v,$ as S,e as H,t as M,bo as P}from"./index-DYOhyz3y.js";import j from"./td-BOJPSNx7.js";import{D as Z}from"./index-CO8NGxNH.js";import{M as q,_ as J}from"./index-Bcw54K48.js";function W(t,c){const o=[];for(const s of t)X(s,c)&&o.push(s);return o}function X(t,c){if(C.isEmpty(t.cond))return!0;const[o,s,e]=t.cond;switch(s){case"EQ":return c[o]==e;case"NQ":return c[o]!=e;case"LT":return c[o]<e;case"LE":return c[o]<=e;case"GT":return c[o]>e;case"GE":return c[o]>=e;case"IN":return e.includes(c[o]);case"NIN":return!e.includes(c[o])}return!0}function Y(t,c){let o=t.url;if(t.args){const s={};for(let e of t.args)C.isObject(e)&&"v"in e&&"k"in e?s[e.v]=c[e.k]:s[e]=c[e];o.includes("?")?o+="&"+new URLSearchParams(s).toString():o+="?"+new URLSearchParams(s).toString()}return{url:o,type:t.type,title:t.title}}const T={filterOption:W,calcOp:Y},tt=["id"],et={key:0,style:{width:"15px"}},nt=["onClick"],at=["innerHTML"],ot={key:1,class:"table-op-col"},st={key:0},lt=["value"],rt={key:0,class:"table-op-col"},it={key:1,class:"table-op-col"},ct=["onClick"],ut={key:2,class:"table-op-col"},yt=F({__name:"table",props:{id:{default:""},rules:{},data:{},option:{default:()=>[]},loading:{type:Boolean,default:!1},sortKey:{},sortOrder:{},noSort:{type:Boolean,default:!1},small:{type:Boolean,default:!1},batchSelect:{type:Boolean,default:!1},width:{default:""},height:{default:""},margin:{default:"0"}},emits:["update:sort-key","update:sort-order","sort-change","op-click"],setup(t,{expose:c,emit:o}){const s=t,e=o,f=O([]),m=O(!1),V=()=>{m.value?f.value=s.data.map(n=>n.id):f.value=[]};B(()=>s.data,()=>{f.value=[],m.value=!1}),B(f,n=>{m.value=n.length===s.data.length});const _=n=>C.isEmpty(n.auto_hide)?"":"auto-hide-"+n.auto_hide;c({getSelectedIds:()=>P(f.value)});const b=E({get:()=>s.sortKey??"",set:n=>e("update:sort-key",n)}),w=E({get:()=>s.sortOrder??"ASC",set:n=>e("update:sort-order",n)}),$=n=>n==b.value?w.value=="ASC"?"fas fa-caret-up":"fas fa-caret-down":"fas fa-unsorted fa-xs",A=(n,r)=>{s.noSort||r.no_sort||(n==b.value?w.value=w.value=="ASC"?"DESC":"ASC":b.value=n,e("sort-change"))},I=()=>{const n=[];for(const r of s.data)r.option=T.filterOption(s.option,r),n.push(r);return n},x=(n,r)=>{e("op-click",T.calcOp(n,r))};return(n,r)=>{const R=J,U=q,K=Z,Q=G;return l(),i("div",null,[k(Q,{spinning:t.loading},{default:p(()=>[d("table",{class:h(["table table-hover",t.small?"table-sm":""]),id:t.id?t.id:void 0,style:N({width:t.width,height:t.height,margin:t.margin})},[d("thead",null,[d("tr",null,[t.batchSelect?(l(),i("th",et,[D(d("input",{type:"checkbox","onUpdate:modelValue":r[0]||(r[0]=a=>m.value=a),onChange:V},null,544),[[L,m.value]])])):g("",!0),(l(!0),i(y,null,v(t.rules,a=>(l(),i("th",{key:a.key,class:h(_(a)),style:{"white-space":"nowrap",cursor:"pointer"},onClick:u=>A(a.key,a)},[d("span",{innerHTML:a.name},null,8,at),r[2]||(r[2]=S()),!t.noSort&&!a.no_sort?(l(),i("i",{key:0,class:h($(a.key))},null,2)):g("",!0)],10,nt))),128)),t.option.length?(l(),i("th",ot,"操作")):g("",!0)])]),d("tbody",null,[(l(!0),i(y,null,v(I(),a=>(l(),i("tr",null,[t.batchSelect?(l(),i("td",st,[D(d("input",{type:"checkbox","onUpdate:modelValue":r[1]||(r[1]=u=>f.value=u),value:a.id},null,8,lt),[[L,f.value]])])):g("",!0),(l(!0),i(y,null,v(t.rules,u=>(l(),i("td",{key:u.key,class:h(_(u)),style:N(u.width?{"word-break":"break-all","max-width":u.width}:{})},[k(j,{r:u,v:a[u.key]},null,8,["r","v"])],6))),128)),t.option.length?(l(),i(y,{key:1},[a.option.length>1?(l(),i("td",rt,[k(K,{placement:"bottomRight",trigger:["click"]},{overlay:p(()=>[k(U,null,{default:p(()=>[(l(!0),i(y,null,v(a.option,(u,z)=>(l(),H(R,{key:z,onClick:ft=>x(u,a)},{default:p(()=>[d("i",{style:{width:"1.5rem"},class:h(`fa fa-${u.icon}`)},null,2),S(" "+M(u.title),1)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),default:p(()=>[r[3]||(r[3]=d("button",{class:"btn btn-default btn-sm"},[d("span",{class:"fa fa-gear fa-sm",style:{"margin-right":"0.5rem"}}),d("span",{class:"fa fa-angle-down"})],-1))]),_:2},1024)])):a.option.length==1&&a.option[0]?(l(),i("td",it,[d("button",{class:"btn btn-sm btn-info",onClick:u=>x(a.option[0],a)},[d("i",{class:h(`fa fa-${a.option[0].icon}`)},null,2),S(" "+M(a.option[0].title),1)],8,ct)])):(l(),i("td",ut," - "))],64)):g("",!0)]))),256))])],14,tt)]),_:1},8,["spinning"])])}}});export{yt as _};
