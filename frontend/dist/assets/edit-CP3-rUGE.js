import{d as A,W as I,r as S,X as $,w as J,e as r,o as i,k as d,b as f,g as j,f as b,a as k,V as u,Y as Q,F as x,U as B,Q as C,l as L,Z as w,t as U,$ as W,R as D,a0 as X,p as Y}from"./index-B79ij98t.js";import{s as Z}from"./strlib-BEzNp4-y.js";import{_ as v}from"./ajax-select.vue_vue_type_script_setup_true_lang-CKB63RLD.js";import{_ as G}from"./tooltip.vue_vue_type_script_setup_true_lang-B6a1x6do.js";import{F as P,_ as ee}from"./index-DErjR01u.js";import{S as te,a as ae}from"./index-84Fh6Zvb.js";import{C as le}from"./index-DiFhWAra.js";import"./index-C4nzcuod.js";import"./Trigger-bEby5AqF.js";import"./firstNotUndefined-CLFzEa0p.js";import"./colors-DwrYPzrp.js";import"./hasIn-yxa9UVPO.js";import"./isSymbol-CcmhocIJ.js";import"./Col-Cu0BhNlX.js";import"./responsiveObserve-B7Xn1p3Q.js";import"./useFlexGapSupport-CrfIlOEx.js";import"./collapseMotion-8U-C_miP.js";import"./debounce-CTKsS_Ar.js";import"./Overflow-BbIXCKr5.js";import"./List-BbMAA7pi.js";import"./isMobile--2fOlCHx.js";import"./useMemo-6CbExqSB.js";import"./useMergedState-ChKKoiD0.js";import"./move-dl2J5Yne.js";import"./slide-QRbVbzTY.js";import"./index-vCwTGQOq.js";const oe=["innerHTML"],ne=["innerHTML"],ie={key:2},Oe=A({__name:"edit",props:{width:{default:"50%"},title:{},subtitle:{default:""},data:{},rules:{default:()=>[]},check:{type:Boolean,default:!1},action:{}},emits:["submit","reload"],setup(o,{emit:F}){const h=o,{data:s,rules:y}=I(h),M=F,_=S(!0),g=S(!1),m=$(T());J(m,a=>{Object.keys(a).forEach(e=>{a[e]||delete n[e]})},{deep:!0});const n=$(E()),O=async()=>{g.value=!0,await L.ajax(h.action??"",H())&&(_.value=!1,M("submit")),g.value=!1};function T(){const a={};for(const e of y.value)a[e.key]=!h.check;return a}function E(){const a={};for(const e of y.value)s.value&&s.value[e.key]!==void 0?e.split_sep&&e.textarea?a[e.key]=String(s.value[e.key]).split(e.split_sep).join(`
`):e.textarea&&e.json?a[e.key]=Z.formatJson(s.value[e.key]):e.split_sep&&e.limit?a[e.key]=String(s.value[e.key]).split(e.split_sep):a[e.key]=s.value[e.key]:e.split_sep&&(e.limit||e.limit_list)?a[e.key]=[]:a[e.key]=e.default||"";return a}function H(){const a={};n.id!==void 0&&(a.id=String(n.id));for(const e of y.value){const c=n[e.key];c!==void 0&&(Y.isArray(c)?e.split_sep?a[e.key]=c.map(p=>String(p)).join(e.split_sep):a[e.key]=c.map(p=>String(p)):a[e.key]=String(c))}return a}return(a,e)=>{const c=Q,p=ee,N=le,V=ae,q=te,R=W,z=P,K=X;return i(),r(K,{width:o.width,"cancel-text":"取消","ok-text":"保存",maskClosable:!1,onOk:O,open:_.value,"onUpdate:open":e[1]||(e[1]=t=>_.value=t),"confirm-loading":g.value},{title:d(()=>[f("div",{innerHTML:o.title},null,8,oe),o.subtitle?(i(),k("div",{key:0,innerHTML:o.subtitle,style:{"font-size":"0.9rem",color:"navy"}},null,8,ne)):b("",!0)]),default:d(()=>[e[4]||(e[4]=f("hr",null,null,-1)),j(z,{model:n,"label-col":{span:4},"wrapper-col":{span:19}},{default:d(()=>[u(s)?.id?(i(),r(p,{key:0,style:{display:"none"}},{default:d(()=>[j(c,{value:n.id,"onUpdate:value":e[0]||(e[0]=t=>n.id=t),type:"hidden"},null,8,["value"])]),_:1})):b("",!0),(i(!0),k(x,null,B(u(y),t=>(i(),k(x,{key:t.key},[!o.check||!t.readonly?(i(),r(p,{key:0,required:t.required&&!o.check},{label:d(()=>[o.check?(i(),r(N,{key:0,checked:m[t.key],"onUpdate:checked":l=>m[t.key]=l},null,8,["checked","onUpdate:checked"])):b("",!0),e[3]||(e[3]=w("   ",-1)),t.describe?(i(),r(G,{key:1,placement:"left",color:"blue",icon:!1,msg:t.describe},{default:d(()=>[e[2]||(e[2]=f("i",{class:"fa fa-info-circle text-info"},null,-1)),w(" "+U(t.name),1)]),_:2},1032,["msg"])):(i(),k("span",ie,U(t.name),1))]),default:d(()=>[t.limit?(i(),r(q,{key:0,value:n[t.key],"onUpdate:value":l=>n[t.key]=l,"show-search":"","allow-clear":"",filterOption:u(L).filterByLabel,placeholder:`请选择${t.name}`,disabled:!m[t.key]||(u(s)?.id||o.check)&&t.readonly,mode:t.split_sep?"multiple":"undefined"},{default:d(()=>[(i(!0),k(x,null,B(t.limit,l=>(i(),r(V,{key:l.key||l,value:l.key!==void 0?l.key:l,label:l.label||l},{default:d(()=>[w(U(l.label||l),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["value","onUpdate:value","filterOption","placeholder","disabled","mode"])):t.trans&&t.trans.ajax?(i(),r(v,{key:1,value:n[t.key],"onUpdate:value":l=>n[t.key]=l,placeholder:`请选择${t.name}`,disabled:!m[t.key]||(u(s)?.id||o.check)&&t.readonly,translate:t.trans},null,8,["value","onUpdate:value","placeholder","disabled","translate"])):t.textarea?C((i(),r(R,{key:2,value:n[t.key],"onUpdate:value":l=>n[t.key]=l,placeholder:`请输入${t.name}，支持换行`,readonly:(u(s)?.id||o.check)&&t.readonly,disabled:!m[t.key]||(u(s)?.id||o.check)&&t.readonly,"auto-size":{minRows:2}},null,8,["value","onUpdate:value","placeholder","readonly","disabled"])),[[D,!o.check||!t.readonly]]):C((i(),r(c,{key:3,value:n[t.key],"onUpdate:value":l=>n[t.key]=l,placeholder:`请输入${t.name}`,readonly:(u(s)?.id||o.check)&&t.readonly,disabled:!m[t.key]||(u(s)?.id||o.check)&&t.readonly},null,8,["value","onUpdate:value","placeholder","readonly","disabled"])),[[D,!o.check||!t.readonly]])]),_:2},1032,["required"])):b("",!0)],64))),128))]),_:1},8,["model"]),e[5]||(e[5]=f("hr",null,null,-1))]),_:1},8,["width","open","confirm-loading"])}}});export{Oe as default};
